<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.1/css/bulma.min.css" integrity="sha512-ZRv40llEogRmoWgZwnsqke3HNzJ0kiI0+pcMgiz2bxO6Ew1DVBtWjVn0qjrXdT3+u+pSN36gLgmJiiQ3cQtyzA==" crossorigin="anonymous" />
  <script  src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script  src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethereum-blockies@0.1.1/blockies.min.js"></script>
  <!-- JS codes start-->
  <script>

const web3 = new Web3('https://bsc-dataseed.binance.org');

var globalGwei = "1";
var myaddress = "0x631Fc1EA2270e98fbD9D92658eCe0F5a269Aa161";
const contractaddress = "0x0456c33f24038bf277a1f1ca27c1999a416bba0d"
const cabi = JSON.parse('[{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"constant":true,"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"_addr","type":"address"},{"internalType":"uint256","name":"_index","type":"uint256"}],"name":"checkmemopurchases","outputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"string","name":"","type":"string"},{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"_addr","type":"address"}],"name":"getmemotextcountforaddr","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"mint","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"renounceOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"_amount","type":"uint256"},{"internalType":"address","name":"_to","type":"address"},{"internalType":"string","name":"_memo","type":"string"}],"name":"sendtokenwithmemo","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"}]');

var eRushCont = new web3.eth.Contract(cabi, contractaddress, { from: myaddress, gasPrice: web3.utils.toWei(globalGwei, 'gwei')});
eRushCont.options.gasPrice = '10';
eRushCont.options.gas = 1000000;
var contractInstance = eRushCont;

function searchboxify(_addr) {
  console.log("hereisworks");
  var getTotalProducts = eRushCont.methods.getmemotextcountforaddr(_addr).call().then(function(result){
                 //the result holds your Token Balance that you can assign to a var
                  console.log(result);
                 var myray = [...Array(result).keys()];

                         for (i = 0; i < result; i++) {
                            console.log("xxx",i);
                            eRushCont.methods.checkmemopurchases(_addr,i).call().then(function(result){
                              //console.log("resolt", result);
                              console.log(result);

                              $("#products").prepend('<tr>'+
                                '<th><figure class="image is-48x48"><img class="is-rounded '+result[3]+'" src=""></figure></th>'+
                                '<td> <a href="https://etherscan.io/address/' + result[3] +'" target="_blank"> '+result[3].substring(1, 8)+'...' + '<a/></td>'+
                                '<td>'+
                                 web3.utils.fromWei(result[1], "ether")+ '-EER'+
                                '</td>'+
                                '<td>'+
                                 result[2]+
                                '</td>'+



                              '</tr>');
                   var icon = blockies.create({ // All options are optional
                       seed: result[3], // seed used to generate icon data, default: random
                       //color: '#dfe', // to manually specify the icon color, default: random
                       //bgcolor: '#aaa', // choose a different background color, default: random
                       size: 15, // width/height of the icon in blocks, default: 8
                       scale: 3, // width/height of each block in pixels, default: 4
                       //spotcolor: '#000' // each pixel has a 13% chance of being of a third color,
                       // default: random. Set to -1 to disable it. These "spots" create structures
                       // that look like eyes, mouths and noses.
                     });
                     console.log(icon);
                     $("."+result[3]).attr('src', icon.toDataURL());
                     });}});
}



</script>
  <!--JS codes end-->
  <title>eRsuh memo explorer</title>
  <link href='https://fonts.googleapis.com/css?family=Nunito Sans' rel='stylesheet'>
  <style>
  html {
    background:#2A1D22;
  }
  .table {
    background-color:#2b1e23;
    border-radius: 10px;

    -moz-box-shadow:    inset 0 0 6px #000000;
    -webkit-box-shadow: inset 0 0 6px #000000;
    box-shadow:
  }
  .table td  {
    color:white;
    font-family: 'Nunito Sans';font-size: 18px;
  }

  .table thead th  {
    color:white;
    font-family: 'Nunito Sans';font-size: 18px;
  }



  .title  {
    color:white;
    font-family: 'Nunito Sans';font-size: 18px;
  }

  .titletwo  {
    color:white;
    font-family: 'Nunito Sans';font-size: 23px;
  }
  .titlethree  {
    color:white;
    font-family: 'Nunito Sans';font-size: 13px;
  }
  .titlethree a{
    color:#1FC7D4;
    font-family: 'Nunito Sans';font-size: 13px;
  }


  .subtitle {
    color:white;
    font-family: 'Nunito Sans';font-size: 18px;
  }
  </style>
</head>
<body>
 <section class="section">
   <div class="container">
  <center><img style="width:100px;" src="https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/240/apple/271/new-moon-face_1f31a.png"></center>
  <center><p class="titletwo">Welcome to ethereum eRush explorer</p><center><br>
    <center><p class="titlethree">Also you can send memo with <a href="https://ethereum-rush.github.io/memosender/" target="_blank">memosender</a></p><center><br>

    <div class="field">
       <div class="control">
         <input id="searchbox" class="input is-primary" style="width:500px;" type="text" placeholder="Search eer address">
       </div>
          </p>
        </div>
        <br>


   <table class="table">
     <tbody id="products">

     </tbody>
   </table>
 </div>
 </section>



<script>
$(document).ready(function() {
$('#searchbox').bind("enterKey",function(e){
   //do stuff here
   var x = $('#searchbox').val();
   console.log(x);
   searchboxify(x);


});
$('#searchbox').keyup(function(e){
    if(e.keyCode == 13)
    {
        $(this).trigger("enterKey");
        console.log("twitter2");
    }
});

});
</script>



 </body>
</html>
